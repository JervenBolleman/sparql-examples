@prefix ex: <https://sparql.uniprot.org/.well-known/sparql-examples/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix schema: <https://schema.org/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .

ex:IDSM_similaritySearch a sh:SPARQLExecutable,
        sh:SPARQLSelectExecutable ;
    rdfs:comment "Sparql query from file IDSM_similaritySearch.rq"^^rdf:HTML ;
    sh:prefixes _:sparql_examples_prefixes ;
    sh:select """
PREFIX as: <https://www.w3.org/ns/activitystreams#>
PREFIX bif: <http://www.openlinksw.com/schemas/bif#>
PREFIX biopax: <http://www.biopax.org/release/biopax-level3.owl#>
PREFIX cas: <https://identifiers.org/cas/>
PREFIX cur: <http://vocabularies.wikipathways.org/wp#Curation:>
PREFIX dawgt: <http://www.w3.org/2001/sw/DataAccess/tests/test-dawg#>
PREFIX dbpedia: <http://dbpedia.org/resource/>
PREFIX dbpprop: <http://dbpedia.org/property/>
PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX efo: <http://www.ebi.ac.uk/efo/>
PREFIX fn: <http://www.w3.org/2005/xpath-functions/#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX formats: <http://www.w3.org/ns/formats/>
PREFIX freq: <http://purl.org/cld/freq/>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX go: <http://purl.org/obo/owl/GO#>
PREFIX gpml: <http://vocabularies.wikipathways.org/gpml#>
PREFIX gqi: <http://www.openlinksw.com/schemas/graphql/intro#>
PREFIX gql: <http://www.openlinksw.com/schemas/graphql#>
PREFIX gr: <http://purl.org/goodrelations/v1#>
PREFIX hmdb: <https://identifiers.org/hmdb/>
PREFIX ldp: <http://www.w3.org/ns/ldp#>
PREFIX math: <http://www.w3.org/2000/10/swap/math#>
PREFIX mesh: <http://purl.org/commons/record/mesh/>
PREFIX mf: <http://www.w3.org/2001/sw/DataAccess/tests/test-manifest#>
PREFIX ncbigene: <https://identifiers.org/ncbigene/>
PREFIX nci: <http://ncicb.nci.nih.gov/xml/owl/EVS/Thesaurus.owl#>
PREFIX oa: <http://www.w3.org/ns/oa#>
PREFIX obo: <http://www.geneontology.org/formats/oboInOwl#>
PREFIX ogc: <http://www.opengis.net/>
PREFIX ogcgml: <http://www.opengis.net/ont/gml#>
PREFIX ogcgs: <http://www.opengis.net/ont/geosparql#>
PREFIX ogcgsf: <http://www.opengis.net/def/function/geosparql/>
PREFIX ogcgsr: <http://www.opengis.net/def/rule/geosparql/>
PREFIX ogcsf: <http://www.opengis.net/ont/sf#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX pav: <http://purl.org/pav/>
PREFIX product: <http://www.buy.com/rss/module/productV2/>
PREFIX protseq: <http://purl.org/science/protein/bysequence/>
PREFIX prov: <http://www.w3.org/ns/prov#>
PREFIX pubmed: <http://www.ncbi.nlm.nih.gov/pubmed/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfa: <http://www.w3.org/ns/rdfa#>
PREFIX rdfdf: <http://www.openlinksw.com/virtrdf-data-formats#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX sc: <http://purl.org/science/owl/sciencecommons/>
PREFIX scovo: <http://purl.org/NET/scovo#>
PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
PREFIX sioc: <http://rdfs.org/sioc/ns#>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX sql: <http://www.openlinksw.com/schemas/sql#>
PREFIX stat: <http://www.w3.org/ns/posix/stat#>
PREFIX vcard: <http://www.w3.org/2001/vcard-rdf/3.0#>
PREFIX vcard2006: <http://www.w3.org/2006/vcard/ns#>
PREFIX virtcxml: <http://www.openlinksw.com/schemas/virtcxml#>
PREFIX virtrdf: <http://www.openlinksw.com/schemas/virtrdf#>
PREFIX void: <http://rdfs.org/ns/void#>
PREFIX wiki: <http://sparql.wikipathways.org/>
PREFIX wp: <http://vocabularies.wikipathways.org/wp#>
PREFIX wprdf: <http://rdf.wikipathways.org/>
PREFIX xf: <http://www.w3.org/2004/07/xpath-functions>
PREFIX xml: <http://www.w3.org/XML/1998/namespace>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX xsl10: <http://www.w3.org/XSL/Transform/1.0>
PREFIX xsl1999: <http://www.w3.org/1999/XSL/Transform>
PREFIX xslwd: <http://www.w3.org/TR/WD-xsl>
PREFIX yago: <http://dbpedia.org/class/yago/>

PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX ebi: <http://ebi.rdf.ac.uk/dataset/>
PREFIX sachem: <http://bioinfo.uochb.cas.cz/rdf/v1.0/sachem#>
PREFIX idsm: <https://idsm.elixir-czech.cz/sparql/endpoint/>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX wp: <http://vocabularies.wikipathways.org/wp#>
PREFIX sso: <http://semanticscience.org/resource/>
PREFIX rh:<http://rdf.rhea-db.org/>
PREFIX rdfs:<http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#>
SELECT distinct ((substr(str(?chebioSrc),32)) as ?SourceOrigin) ((substr(str(?similarSrc),32)) as ?SourceSimilar) ((substr(str(?chebioTgt),32)) as ?TargetOrigin) ((substr(str(?similarTgt),32)) as ?TargetSimilar)  #?reaction 
WHERE {
  ?interaction dcterms:isPartOf ?pathway ; a wp:Conversion ;
      wp:source ?source ;
      wp:target ?target .
    ?source wp:bdbChEBI ?chebiSrc .
    ?target wp:bdbChEBI ?chebiTgt .
    ?pathway dcterms:identifier "WP4225".
    BIND(iri(concat("http://purl.obolibrary.org/obo/CHEBI_", substr(str(?chebiSrc),37))) AS ?chebioSrc)
    BIND(iri(concat("http://purl.obolibrary.org/obo/CHEBI_", substr(str(?chebiTgt),37))) AS ?chebioTgt)
#IDSM
SERVICE <https://idsm.elixir-czech.cz/sparql/endpoint/chebi> {
   ?chebioSrc ^sso:is-attribute-of / sso:has-value ?molfileSrc .
 ?chebioTgt ^sso:is-attribute-of / sso:has-value ?molfileTgt .
  [ sachem:compound ?similarSrc; sachem:score ?scoreSrc ]
    sachem:similaritySearch [
      sachem:query ?molfileSrc ;
     sachem:cutoff 98e-2
    ].
  [ sachem:compound ?similarTgt; sachem:score ?scoreTgt ]
    sachem:similaritySearch [
      sachem:query ?molfileTgt ;
      sachem:cutoff 98e-2 
    ] .
  }
 }
""" ;
    schema:target <https://sparql.wikipathways.org/sparql/> .
