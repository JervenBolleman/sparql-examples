@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-907b95429164a2dd56a6e728c2d9ec26> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  sh:select """prefix void:  <http://rdfs.org/ns/void#>
prefix pav:   <http://purl.org/pav/>
prefix xsd:   <http://www.w3.org/2001/XMLSchema#>
prefix freq:  <http://purl.org/cld/freq/>
prefix biopax: <http://www.biopax.org/release/biopax-level3.owl#>
prefix skos:  <http://www.w3.org/2004/02/skos/core#>
prefix rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
prefix rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix gpml:  <http://vocabularies.wikipathways.org/gpml#>
prefix wp:    <http://vocabularies.wikipathways.org/wp#>
prefix dcterms: <http://purl.org/dc/terms/>
prefix wprdf: <http://rdf.wikipathways.org/>
prefix prov:  <http://www.w3.org/ns/prov#>
prefix foaf:  <http://xmlns.com/foaf/0.1/>
prefix dc:    <http://purl.org/dc/elements/1.1/>

SELECT DISTINCT ?biomarkerLabel ?proteinLabel ?geneID ?WP_gene ?PathwayID ?PathwayName #results that are displayed.
WHERE {
  VALUES ?biomarker {wd:Q420633 wd:Q27125809 wd:Q422462} #you can add more biomarkers here if needed, separated by a space.
  ?biomarker wdt:P31 wd:Q11173. #Stating that all biomarkers have to be \"instance of\" \"chemical compound\" (you could ommit this, but query will probably take longer).
  ?biomarker wdt:P638 ?pdbID . #Checking if a biomarker has a Protein Databank ID (PDB) -> meaning the metabolite can interact with a protein.
  ?protein wdt:P31 wd:Q8054 . #Stating that all proteins are \"instance of\" \"protein\"
  ?protein wdt:P638 ?pdbID . #Checking which proteins have a PDB ID, which we queried previously in relationship to the biomarkers.
  ?protein wdt:P702 ?gene . #Connecting the protein to a gene (\"encoded by\" relationship) -> to get an identifier we can use later in federated WikiPathways query.
  ?gene wdt:P703 wd:Q15978631 . #Now removing all genes that are not found in species \"Homo sapiens\". -> This info is not always available for proteins in WikiData.
  ?gene wdt:P2888 ?geneID . #Getting the \"exact match\" identifier for the gene, related to the protein, related to the biomarker.

  ##The IRI from Wikidata starts with http:// , where the one from WikiPathways starts with https:// , so we need to rewrite the IRI
    BIND(                      # Bind the created IRI into a new variable (called ?newIRI)
        IRI(                   # Convert the string back to an IRI
          CONCAT(              # Concatenate item 1 and 2 together as one string
               \"https\",        # First item to concat (more items can be added with a comma
              #Second item to concat:
               SUBSTR(         # Obtain a substring
                 STR(?geneID), # Convert the geneID IRI from Wikidata to a string,
                 5)            # removing the first 5 characters (<http)
        )) AS ?newIRI          # Name for the new variable
    )

  SERVICE <http://sparql.wikipathways.org/sparql> { #Connecting to the WikiPathways SPARQL endpoint.
     ?WP_pathway a wp:Pathway . #Stating a ?WP_pathway is indeed a pathway in the WikiPathways RDF .
     ?WP_pathway wp:organismName \"Homo sapiens\" . #Removing all PWs not for species Homo sapiens.
     ?WP_pathway dc:identifier ?PathwayID . #Query the identifier of the pathway in WPs.
     ?WP_pathway dc:title ?PathwayName . #Obtaining the name of the pathway.

     ?WP_gene a wp:Protein . #Stating that a ?WP_gene is a Protein DataNode (you could ommit this, to also get all DataNodes modeled as GeneProducts out, but query will take longer).
     ?WP_gene wp:bdbEntrezGene ?newIRI . #Connecting the previously queried \"exact match\" from WikiData to the NCBI/Entrez Gene ID in WPs.
     ?WP_gene dcterms:isPartOf ?WP_pathway . #Connecting the WP_gene to the WP_pathway.

   }
 OPTIONAL {?biomarker rdfs:label ?biomarkerLabel. #Create a label (aka name) for the biomarkers in WikiData, without using the service query.
FILTER(LANG(?biomarkerLabel) = \"en\").
}
   OPTIONAL {?protein rdfs:label ?proteinLabel. #Create a label(aka name) for the proteins in WikiData, without using the service query.
FILTER(LANG(?proteinLabel) = \"en\").
}

}
ORDER BY DESC (?biomarkerLabel) #Order results for biomarkers""";
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:wikidata_prefixes, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-wikidata_prefixes,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-E9007819B1D24733B1A4143BC3C94794, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-8DCAD531B720AA6731FB66ECD64EF7F8,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-6665A322FAF4F1B99BBF4156E3A01347, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-190ADE27DC4AD90387CFA6E50B2B01F4,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-42A927275C31A3CCF3B87A011D183BA1, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-94DCBFC781F74AF314100FD296F6A592,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-42814EE25C64F391FA2BFE59D39424B1, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-ACFF74844B9FD1DD8A3A5A296712BB6E,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-305137A21C01514BD759A37D40E83EC4, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-A8FF17A999BB1D56C9682ADDF5EC4D31,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-E3DB9BD28EC1C37326A3B5DD36DCCA0F, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-21FCFF4EA5C26E4F35A7CF4018080F82,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-AB7D11B14E044334BAA25AAEB33D5A77, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-A019205AFF3C13B60598365E9003ACCE,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-1E87D7C467D3AAF6E1129A2916B4D2A9, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-A28E80C0CE2FCCC1823B280BB1C93A9A,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-E32165C37293858790DF0FD147E25905, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-F02D366772B82D928777BF385F78634D,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-2B39FC2E083B5C88E21752D7FF447344, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-EE5AE6FB38F8AC4F62D20023DE1C4AAD,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-8BE9A4E6420BE1129B28FC314411695B, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-E845AC9D6EC26EB6BA2CDFE970FDA5AB,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-50826E8C2CDBEE5B34D4DD1C46A7FE1E, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-FCB9512F537B5F41A86BDEF772E2CA39,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-3448F879869F5E331A16A76752EE2B43, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-132FA18F9E697F085B80AAF14CFB613A,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-FE1E978FD44FDE55ED16B79AD8CB9C6F, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-7B607490E2DA652B41F2F06EDC2B6EA3,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-B40A0EC3058C705CF8C90CF60888D0A6, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-3043F1A68801D4766859E39A9856A2DB,
    _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-AE8B121CF02BF8F03205469013AD1460, _:genid-9eb55b2583ef4ad09d9d48ff9f18ffec115868-E194A84D406D25A3827FF5094B30F6B6;
  schema:target <https://query.wikidata.org/sparql/> .
